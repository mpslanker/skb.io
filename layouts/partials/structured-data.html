{{- $page := . -}}
{{- $site := .Site -}}

{{- if .IsHome -}}
  {{- $structuredData := dict "@context" "https://schema.org" "@type" "WebSite" "name" $site.Title "url" $site.BaseURL "description" $site.Params.description "author" (dict "@type" "Person" "name" $site.Params.author.name) "publisher" (dict "@type" "Organization" "name" $site.Title "logo" (dict "@type" "ImageObject" "url" (printf "%s%s" $site.BaseURL $site.Params.logo))) -}}
  {{- $structuredData = merge $structuredData (dict "potentialAction" (dict "@type" "SearchAction" "target" (printf "%s/search/?q={search_term_string}" $site.BaseURL) "query-input" "required name=search_term_string")) -}}
  <script type="application/ld+json">{{ $structuredData | jsonify }}</script>
{{- else if .IsPage -}}
  {{- $structuredData := dict "@context" "https://schema.org" "@type" "Article" "headline" .Title "description" .Description "url" .Permalink "datePublished" (.Date.Format "2006-01-02T15:04:05Z07:00") "dateModified" (.Lastmod.Format "2006-01-02T15:04:05Z07:00") "author" (dict "@type" "Person" "name" $site.Params.author.name) "publisher" (dict "@type" "Organization" "name" $site.Title "logo" (dict "@type" "ImageObject" "url" (printf "%s%s" $site.BaseURL $site.Params.logo))) -}}
  
  {{- if .Params.featuredImage -}}
    {{- $image := .Resources.GetMatch .Params.featuredImage -}}
    {{- if $image -}}
      {{- $structuredData = merge $structuredData (dict "image" (dict "@type" "ImageObject" "url" $image.Permalink "width" $image.Width "height" $image.Height)) -}}
    {{- end -}}
  {{- end -}}
  
  {{- if .Params.categories -}}
    {{- $structuredData = merge $structuredData (dict "articleSection" (index .Params.categories 0)) -}}
  {{- end -}}
  
  {{- if .Params.tags -}}
    {{- $structuredData = merge $structuredData (dict "keywords" (delimit .Params.tags ", ")) -}}
  {{- end -}}
  
  {{- if .WordCount -}}
    {{- $structuredData = merge $structuredData (dict "wordCount" .WordCount) -}}
  {{- end -}}
  
  <script type="application/ld+json">{{ $structuredData | jsonify }}</script>
{{- else if .IsSection -}}
  {{- $structuredData := dict "@context" "https://schema.org" "@type" "CollectionPage" "name" .Title "description" .Description "url" .Permalink "mainEntity" (dict "@type" "ItemList" "numberOfItems" (len .Pages)) -}}
  <script type="application/ld+json">{{ $structuredData | jsonify }}</script>
{{- end -}}
